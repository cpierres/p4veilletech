spring:
  application:
    name: backend

  ai:
    openai:
      api-key: ${OPENAI_API_KEY}
    vectorstore:
      pgvector:
        schema: public
        table-name: vector_store # nom de la table pgvector pour les embeddings
        # distance-type: COSINE     # L2, COSINE, or INNER_PRODUCT
        initialize-schema: false     # géré par Flyway désormais
        remove-existing-vector-store-table: false

  datasource:
    url: jdbc:postgresql://localhost:5432/veilltech
    username: ${POSTGRES_USER:veilltech}
    password: ${POSTGRES_PASSWORD:veilltech}
    driver-class-name: org.postgresql.Driver

  r2dbc:
    url: r2dbc:postgresql://localhost:5432/veilltech
    username: ${POSTGRES_USER:veilltech}
    password: ${POSTGRES_PASSWORD:veilltech}

  flyway:
    enabled: true
    baseline-on-migrate: true

logging:
  level:
    org.springframework.ai.vectorstore.pgvector: INFO
    org.springframework.r2dbc.connection: WARN

# Application specific settings
app:
  embedding:
    # provider can be: ollama (default), openai, cohere
    provider: ${EMBEDDING_PROVIDER:openai}
    # If using Ollama locally, leave baseUrl as default
    # baseUrl: ${OLLAMA_BASE_URL:http://localhost:11434}
    # Model name for embeddings
    # Recommended lightweight options:
    # - all-minilm (MiniLM-L6-v2, 384 dims, fast, English-focused)
    # - paraphrase-multilingual-MiniLM-L12-v2 (384 dims, multilingual FR/EN)
    # model: ${EMBEDDING_MODEL:all-minilm}
    # Embedding dimension for the selected model
    # all-MiniLM-L6-v2 = 384, paraphrase-multilingual-MiniLM-L12-v2 = 384
    # dimension: ${EMBEDDING_DIMENSION:384}

  github:
    token: ${GITHUB_TOKEN:}
    default-branch: ${GITHUB_DEFAULT_BRANCH:main}
    eval-file: classpath:skills-data/md/ocr-projets-descriptions-evaluations/projets-openclassrooms-evaluations.md
    http-timeout-ms: 15000
    webhook:
      secret: ${GITHUB_WEBHOOK_SECRET}
